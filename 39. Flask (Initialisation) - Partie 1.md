# <h1 id="cours-api-flask"> Flask (Initialisation) - Partie 1 </h1>

## Objectifs du cours

À la fin de ce cours, vous serez capable de :

* Installer et configurer Flask
* Comprendre la différence entre application web et API REST
* Créer des routes HTTP (GET, POST, PUT, DELETE)
* Gérer les données en JSON
* Créer un micro-service en Flask
* Utiliser Postman ou `curl` pour tester votre API



## <h2 id="prerequis">1. Prérequis</h2>

* Python installé (recommandé : version 3.10 ou 3.11)
* Un terminal (CMD, PowerShell, ou Bash)
* Connaissance basique de Python (fonctions, dictionnaires, etc.)



## <h2 id="etape1">2. Créer un dossier de projet</h2>

Dans votre explorateur de fichiers ou terminal :

```
mkdir projet_api_flask
cd projet_api_flask
```



## <h2 id="etape2">3. Créer un environnement virtuel</h2>

Dans le terminal :

```
python -m venv env
```

Activer l’environnement virtuel :

* Windows :

```
.\env\Scripts\activate
```

* Mac/Linux :

```
source env/bin/activate
```



## <h2 id="etape3">4. Installer Flask</h2>

```
pip install flask
```

Vérifier :

```
pip show flask
```



## <h2 id="etape4">5. Créer le fichier principal `app.py`</h2>

Créer un fichier `app.py` :

```python
from flask import Flask, jsonify

app = Flask(__name__)

@app.route("/")
def home():
    return jsonify({"message": "Bienvenue sur votre première API Flask"})

if __name__ == "__main__":
    app.run(debug=True)
```



## <h2 id="etape5">6. Lancer le serveur</h2>

Dans le terminal :

```
python app.py
```

Vous verrez :

```
Running on http://127.0.0.1:5000/
```

Accédez à `http://127.0.0.1:5000/` dans votre navigateur. Vous verrez :

```json
{"message": "Bienvenue sur votre première API Flask"}
```



## <h2 id="etape6">7. Ajouter des données simulées</h2>

Ajouter un "faux" ensemble de données dans le fichier `app.py` :

```python
etudiants = [
    {"id": 1, "nom": "Durand", "prenom": "Julie"},
    {"id": 2, "nom": "Martin", "prenom": "Luc"}
]
```



## <h2 id="etape7">8. Route GET – Obtenir tous les étudiants</h2>

```python
@app.route("/api/etudiants", methods=["GET"])
def get_etudiants():
    return jsonify(etudiants)
```

Aller sur `http://127.0.0.1:5000/api/etudiants`
Vous verrez :

```json
[
    {"id": 1, "nom": "Durand", "prenom": "Julie"},
    {"id": 2, "nom": "Martin", "prenom": "Luc"}
]
```


## <h2 id="etape8">9. Route GET – Obtenir un étudiant par ID</h2>

```python
@app.route("/api/etudiants/<int:id>", methods=["GET"])
def get_etudiant(id):
    for e in etudiants:
        if e["id"] == id:
            return jsonify(e)
    return jsonify({"message": "Étudiant introuvable"}), 404
```



## <h2 id="etape9">10. Route POST – Ajouter un étudiant</h2>

```python
from flask import request

@app.route("/api/etudiants", methods=["POST"])
def ajouter_etudiant():
    data = request.get_json()
    nouvel_etudiant = {
        "id": len(etudiants) + 1,
        "nom": data.get("nom"),
        "prenom": data.get("prenom")
    }
    etudiants.append(nouvel_etudiant)
    return jsonify(nouvel_etudiant), 201
```

Tester avec Postman ou `curl` :

```bash
curl -X POST http://127.0.0.1:5000/api/etudiants \
-H "Content-Type: application/json" \
-d "{\"nom\": \"Benoit\", \"prenom\": \"Claire\"}"
```



## <h2 id="etape10">11. Route PUT – Modifier un étudiant</h2>

```python
@app.route("/api/etudiants/<int:id>", methods=["PUT"])
def modifier_etudiant(id):
    data = request.get_json()
    for e in etudiants:
        if e["id"] == id:
            e["nom"] = data.get("nom", e["nom"])
            e["prenom"] = data.get("prenom", e["prenom"])
            return jsonify(e)
    return jsonify({"message": "Étudiant introuvable"}), 404
```


## <h2 id="etape11">12. Route DELETE – Supprimer un étudiant</h2>

```python
@app.route("/api/etudiants/<int:id>", methods=["DELETE"])
def supprimer_etudiant(id):
    for e in etudiants:
        if e["id"] == id:
            etudiants.remove(e)
            return jsonify({"message": "Étudiant supprimé"})
    return jsonify({"message": "Étudiant introuvable"}), 404
```


## <h2 id="etape12">13. Résumé des routes</h2>

| Méthode | URL                   | Fonction                       |
| ------- | --------------------- | ------------------------------ |
| GET     | `/api/etudiants`      | Obtenir tous les étudiants     |
| GET     | `/api/etudiants/<id>` | Obtenir un étudiant            |
| POST    | `/api/etudiants`      | Ajouter un étudiant            |
| PUT     | `/api/etudiants/<id>` | Modifier un étudiant existant  |
| DELETE  | `/api/etudiants/<id>` | Supprimer un étudiant existant |


## <h2 id="etape13">14. Structure finale du projet</h2>

```
projet_api_flask/
│
├── env/               ← environnement virtuel
├── app.py             ← fichier principal Flask
└── requirements.txt   ← (optionnel, avec `pip freeze > requirements.txt`)
```


## <h2 id="etape14">15. Conseils pédagogiques</h2>

* Vérifier la syntaxe ligne par ligne
* Expliquer les fonctions HTTP : GET, POST, PUT, DELETE
* Expliquer ce qu’est un `JSON`
* Utiliser `print()` pour afficher `data` en console si besoin
* Toujours redémarrer le serveur Flask après modification


## <h2 id="bonus">16. Bonus – Ajouter le CORS</h2>

Si vous testez depuis un frontend dans un navigateur, installez :

```bash
pip install flask-cors
```

Ajoutez dans `app.py` :

```python
from flask_cors import CORS
CORS(app)
```


