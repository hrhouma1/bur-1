# Projet : Système de Gestion Étudiants avec Suppression en Cascade


## Contexte et Objectifs

Vous devez développer une application de gestion d'étudiants universitaires avec leurs cartes étudiantes. L'objectif principal est de maîtriser les **relations en cascade** dans SQLAlchemy : quand un étudiant est supprimé, sa carte étudiante doit être automatiquement supprimée.

### Compétences évaluées :
- Conception de base de données relationnelle
- Maîtrise de SQLAlchemy ORM
- Relations et contraintes d'intégrité
- Suppression en cascade
- Interface graphique PySide6
- Architecture MVC simple



## Spécifications Techniques

### Environnement de développement :
- **Python :** 3.10 ou supérieur
- **Base de données :** SQLite (fichier local)
- **ORM :** SQLAlchemy 2.0+
- **Interface :** PySide6
- **Environnement virtuel :** Obligatoire

### Structure du projet attendue :
```
mon_projet/
├── database.py          # Modèles SQLAlchemy
├── interface.py         # Interface graphique
├── main.py             # Application principale
├── requirements.txt    # Dépendances
├── README.md          # Documentation
└── test_demo.py       # Script de démonstration (optionnel)
```



## Partie 1 : Base de Données (6 points)

### 1.1 Configuration SQLAlchemy (2 points)

Créez le fichier `database.py` avec :
- Connexion à une base SQLite nommée `universite.db`
- Configuration avec `echo=True` pour voir les requêtes SQL
- Session configurée correctement
- Imports nécessaires

### 1.2 Entité Étudiant (2 points)

Créez une classe `Etudiant` avec les propriétés :
- `id` : clé primaire auto-incrémentée
- `nom` : chaîne de caractères obligatoire (max 50 caractères)
- `prenom` : chaîne de caractères obligatoire (max 50 caractères)  
- `email` : chaîne de caractères obligatoire (max 100 caractères)
- `date_inscription` : date/heure, par défaut la date courante

**Contraintes :**
- Table nommée `etudiants`
- Méthode `__repr__` pour affichage lisible

### 1.3 Entité Carte Étudiante (2 points)

Créez une classe `CarteEtudiante` avec :
- `id` : clé primaire auto-incrémentée
- `numero_carte` : chaîne unique obligatoire (max 20 caractères)
- `date_emission` : date/heure, par défaut la date courante
- `date_expiration` : date/heure obligatoire
- `statut` : chaîne, par défaut "active" (valeurs : active, perdue, expiree)
- `etudiant_id` : clé étrangère vers la table `etudiants`

**Contraintes :**
- Table nommée `cartes_etudiantes`
- **Relation CASCADE** : suppression d'un étudiant supprime sa carte
- Méthode `__repr__` pour affichage



## Partie 2 : Interface Graphique (6 points)

### 2.1 Structure de base (2 points)

Créez le fichier `interface.py` avec une classe `Ui_MainWindow` contenant :
- Fenêtre principale de taille 800x600
- Titre approprié
- Layout organisé en sections distinctes

### 2.2 Section Ajout d'Étudiant (2 points)

Créez une section "Ajouter un Étudiant" avec :
- **Champs de saisie :**
  - Nom (QLineEdit avec placeholder)
  - Prénom (QLineEdit avec placeholder)
  - Email (QLineEdit avec placeholder et validation)
- **Bouton :** "Ajouter Étudiant + Carte"
- **Organisation :** Utiliser QGroupBox et layouts appropriés

### 2.3 Section Liste et Gestion (2 points)

Créez une section "Gestion des Étudiants" avec :
- **Bouton :** "Actualiser la Liste"
- **Liste :** QListWidget pour afficher les étudiants avec leurs cartes
- **Bouton :** "Supprimer Étudiant Sélectionné (+ sa carte)"
- **Zone de messages :** QTextEdit en lecture seule pour les retours



## Partie 3 : Logique Applicative (6 points)

### 3.1 Application principale (2 points)

Créez le fichier `main.py` avec :
- Classe `Application` héritant de `QMainWindow`
- Initialisation correcte de l'interface
- Connexion des boutons aux méthodes appropriées
- Gestion du cycle de vie de l'application

### 3.2 Ajout d'étudiants avec cartes (2 points)

Implémentez la méthode `ajouter_etudiant()` qui :
- **Récupère** les données des champs de saisie
- **Valide** que tous les champs sont remplis
- **Valide** le format de l'email (présence du symbole @)
- **Crée** un étudiant en base de données
- **Génère** automatiquement une carte avec :
  - Numéro unique (ex: "CARTE" + 8 chiffres aléatoires)
  - Date d'expiration : 4 ans après la création
- **Affiche** un message de confirmation avec les détails
- **Vide** les champs après ajout réussi
- **Actualise** la liste des étudiants

### 3.3 Suppression avec cascade (2 points)

Implémentez :
- **Méthode `actualiser_liste()`** : charge et affiche tous les étudiants avec leurs cartes
- **Méthode `supprimer_etudiant()`** qui :
  - Vérifie qu'un étudiant est sélectionné
  - Demande confirmation avec un QMessageBox
  - Supprime l'étudiant (la carte doit être supprimée automatiquement)
  - Affiche le résultat de la suppression
  - Actualise la liste



## Partie 4 : Fonctionnalités Avancées (2 points)

### 4.1 Gestion d'erreurs (1 point)

Ajoutez une gestion d'erreurs robuste :
- Try/catch dans toutes les méthodes critiques
- Rollback en cas d'erreur de base de données
- Messages d'erreur clairs pour l'utilisateur
- Validation des données avant insertion

### 4.2 Démonstration cascade (1 point)

Créez une fonctionnalité de démonstration :
- Bouton "Démonstration Cascade"
- Création automatique de 3 étudiants de test avec leurs cartes
- Suppression de l'un d'eux pour montrer le cascade
- Affichage des statistiques avant/après



## Livrables et Évaluation

### Fichiers à rendre :
1. **`database.py`** - Modèles SQLAlchemy avec cascade
2. **`interface.py`** - Interface graphique complète  
3. **`main.py`** - Application fonctionnelle
4. **`requirements.txt`** - Liste des dépendances
5. **`README.md`** - Instructions d'installation et utilisation

### Critères d'évaluation :

| Critère | Points | Description |
|---------|--------|-------------|
| **Base de données** | 6 | Modèles corrects, relation cascade fonctionnelle |
| **Interface** | 6 | Interface claire, intuitive et complète |
| **Logique** | 6 | Fonctionnalités implémentées, gestion d'erreurs |
| **Fonctionnalités** | 2 | Aspects avancés et démonstration |
| **Total** | **20** | |

### Bonus (+2 points) :
- Interface particulièrement soignée
- Fonctionnalités supplémentaires créatives
- Code exceptionnellement bien documenté
- Tests automatisés



## Instructions de Développement

### Étape 1 - Préparation (30 minutes)
1. Créer le dossier du projet
2. Initialiser l'environnement virtuel
3. Installer les dépendances
4. Créer la structure de fichiers

### Étape 2 - Base de données (2-3 heures)
1. Configurer SQLAlchemy
2. Créer les modèles `Etudiant` et `CarteEtudiante`
3. Définir la relation avec cascade
4. Tester la création des tables

### Étape 3 - Interface (2-3 heures)
1. Concevoir l'interface avec Qt Designer (optionnel) ou directement en Python
2. Organiser les sections logiquement
3. Ajouter tous les widgets nécessaires
4. Tester l'affichage

### Étape 4 - Logique (4-5 heures)
1. Implémenter l'ajout d'étudiants
2. Implémenter l'affichage des listes
3. Implémenter la suppression avec cascade
4. Tester toutes les fonctionnalités

### Étape 5 - Finalisation (1-2 heures)
1. Améliorer la gestion d'erreurs
2. Ajouter la démonstration cascade
3. Documenter le code
4. Créer le README



## Conseils et Bonnes Pratiques

### Développement :
- **Commencez simple** : implémentez d'abord les fonctionnalités de base
- **Testez fréquemment** : vérifiez chaque étape avant de passer à la suivante
- **Utilisez des noms explicites** : variables, méthodes et classes bien nommées
- **Commentez votre code** : expliquez les parties complexes

### Base de données :
- Vérifiez que la cascade fonctionne en inspectant la base
- Utilisez `echo=True` pour voir les requêtes SQL générées
- Testez la création/suppression avec des données simples d'abord

### Interface :
- Organisez l'interface de manière logique et intuitive
- Donnez des noms clairs aux widgets pour faciliter l'accès
- Utilisez des layouts pour une présentation professionnelle
- Ajoutez des placeholders explicites dans les champs

### Gestion d'erreurs :
- Anticipez les erreurs utilisateur (champs vides, sélection vide)
- Gérez les erreurs de base de données (contraintes, connexion)
- Affichez des messages d'erreur compréhensibles



## Ressources Autorisées

- Documentation officielle SQLAlchemy
- Documentation officielle PySide6
- Cours et exemples vus en classe
- Recherches sur Stack Overflow pour des problèmes spécifiques



## Critères de Réussite

### Minimum viable (Note ≥ 10) :
- Application se lance sans erreur
- Ajout d'étudiants fonctionnel
- Affichage de la liste opérationnel
- Suppression en cascade effective

### Travail satisfaisant (Note ≥ 14) :
- Toutes les fonctionnalités de base
- Interface claire et intuitive
- Gestion d'erreurs basique
- Code propre et commenté

### Excellent travail (Note ≥ 18) :
- Fonctionnalités avancées implémentées
- Interface professionnelle
- Gestion d'erreurs complète
- Code exemplaire avec documentation

**Bon développement !**
