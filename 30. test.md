
 
 
 > Ensemble **exhaustif de requ√™tes SQLite** pour **analyser la structure compl√®te** de ta base `etudiants_cartes.db`, avec **commentaires explicatifs** √† chaque √©tape. 
 > Toutes les commandes sont √† ex√©cuter dans `sqlite3`.


## üìå 1. Lister toutes les tables de la base

```sql
.tables
```

> Liste tous les noms de tables dans la base.
> Exemple de sortie : `cartes  etudiants`


## üìå 2. Obtenir la requ√™te de cr√©ation d'une table (structure SQL compl√®te)

```sql
.schema etudiants
```

```sql
.schema cartes
```

> Affiche la requ√™te `CREATE TABLE` utilis√©e pour cr√©er la table.
> Permet de voir les types, les contraintes, les cl√©s primaires et √©trang√®res.


## üìå 3. Lister les colonnes d‚Äôune table avec d√©tails

```sql
PRAGMA table_info(etudiants);
```

```sql
PRAGMA table_info(cartes);
```

> Affiche un tableau contenant :

* `cid` : identifiant de la colonne
* `name` : nom de la colonne
* `type` : type de donn√©es (`INTEGER`, `TEXT`, `VARCHAR`, etc.)
* `notnull` : 1 si la colonne est NOT NULL
* `dflt_value` : valeur par d√©faut
* `pk` : 1 si la colonne fait partie de la cl√© primaire



## üìå 4. Lister les index cr√©√©s sur une table

```sql
PRAGMA index_list(etudiants);
```

```sql
PRAGMA index_list(cartes);
```

> Affiche les index cr√©√©s automatiquement ou manuellement :

* Nom de l‚Äôindex
* S‚Äôil est `UNIQUE`
* S‚Äôil est `origin` (ex: `pk`, `u`, `c`)
* S‚Äôil a √©t√© cr√©√© automatiquement



## üìå 5. Obtenir le d√©tail d‚Äôun index sp√©cifique

```sql
PRAGMA index_info(nom_de_l_index);
```

> Permet de voir les colonnes concern√©es par un index donn√©.
> √Ä utiliser apr√®s avoir list√© les index avec `PRAGMA index_list(...)`.



## üìå 6. V√©rifier les cl√©s √©trang√®res d'une table

```sql
PRAGMA foreign_key_list(cartes);
```

> Affiche les cl√©s √©trang√®res d√©finies dans la table `cartes`, notamment :

* La colonne locale (`etudiant_id`)
* La table r√©f√©renc√©e (`etudiants`)
* La colonne de r√©f√©rence (`id`)
* Les actions `ON UPDATE`, `ON DELETE`



## üìå 7. V√©rifier si les cl√©s √©trang√®res sont activ√©es dans cette session SQLite

```sql
PRAGMA foreign_keys;
```

> Doit renvoyer `1`. Sinon, ex√©cuter :

```sql
PRAGMA foreign_keys = ON;
```


## üìå 8. Voir tous les types d‚Äôobjets dans la base (tables, index, views...)

```sql
SELECT name, type, tbl_name
FROM sqlite_master
WHERE type IN ('table', 'index', 'view', 'trigger')
ORDER BY type, name;
```

> Permet de voir tout ce que contient la base, avec le nom de chaque objet SQL.



## üìå 9. Voir la requ√™te SQL compl√®te ayant cr√©√© chaque objet

```sql
SELECT type, name, sql
FROM sqlite_master
ORDER BY type, name;
```

> Affiche pour chaque objet SQL (table, index...) la requ√™te `CREATE`.



## üìå 10. Inspecter les premi√®res lignes des tables (aper√ßu du contenu)

```sql
SELECT * FROM etudiants LIMIT 5;
```

```sql
SELECT * FROM cartes LIMIT 5;
```


## üìå 11. Afficher la structure logique de la relation 1:1

```sql
SELECT e.id, e.nom, e.prenom, c.numero
FROM etudiants e
LEFT JOIN cartes c ON e.id = c.etudiant_id;
```

> Permet de voir les √©tudiants et leur carte associ√©e.
> Affiche les donn√©es li√©es par la relation 1:1 via la cl√© √©trang√®re `etudiant_id`.



## üìå 12. Obtenir la taille (en nombre de lignes) de chaque table

```sql
SELECT 'etudiants' AS table_name, COUNT(*) AS total FROM etudiants
UNION ALL
SELECT 'cartes', COUNT(*) FROM cartes;
```



## üìå 13. Rechercher les cartes sans √©tudiant associ√© (incoh√©rences)

```sql
SELECT * FROM cartes
WHERE etudiant_id NOT IN (SELECT id FROM etudiants);
```

> Cette requ√™te permet de d√©tecter les entr√©es orphelines (normalement impossibles si la cl√© √©trang√®re est active).



## üìå 14. Exporter la structure de la base en SQL

Dans `sqlite3`, tapez :

```sql
.output structure.sql
.schema
.output stdout
```

> Cela enregistre toute la structure SQL dans un fichier `structure.sql`.



## üìå 15. Exporter les donn√©es de la base

```sql
.output export_data.sql
.dump
.output stdout
```

> Cela exporte √† la fois la structure et les donn√©es (INSERT) dans `export_data.sql`.


